# Día 22 - Desarrollo de la aplicación Fullstack (React, Node.js y Express)

## Viernes 3 de octubre de 2025

## Lo conseguido hoy:

### Backend

- Modificado el middleware **errorHandler**. Añadido nuevos tipos de errores.

- Modificados **todos los controllers**. Ahora todos envían **los errores al errorHandler**.

- Creado el archivo **helpers.js** para reutilizar código.

- Creado el archivo **validations.js**, que usa Joi para hacer validaciones de datos en las requests.

### Frontend

- Primeras **validaciones con Yup en LoginForm**. (Hay que mejorarlo).

## Lo que se desea realizar:

### Backend

- Si he borrado el user de mi base de datos, pero sigo teniendo el token, **sigo con la sesión iniciada, aunque no pueda hacer nada con ese token**. Me gustaría poder indicar que la cuenta con la que está iniciada la sesión se ha borrado, y no puede hacer nada más que cerrar sesión. Una solución que he pensado a este problema es que en la petición, se devuelva cierta info que indique que se ha rechazado la solicitud porque ya no existe ese usuario, y que, **de alguna manera, se elimine el token directamente del localStorage**, que es lo que hace que dependa el estado global de Redux.

### Frontend

- Implementar **validaciones de entrada de login y signup**.

- Desarrollar **apartado de mi cuenta**, para poder borrar, modificar, etc...

- Implementar el /health correctamente.

### Comentarios Finales

- **Manejo de errores** falta por implementar en la mayoría de la aplicación.

### Problemas que tengo

- De momento, el get de weeks lo hago en el nuevo custom hook **useInitWeeks**, puesto que **useWeeks usa useState dentro, por lo tanto se me harían llamadas infinitas**. En un futuro, miraré cómo compactar los custom hooks que tengo. (30/09/2025)

- **Duda (IMPORTANTE)**: Si ahora mismo, como tengo el modelo de MealAliment, me supongo que se podría hacer un POST en el que se pudiera añadir un alimento a una comida, que ese alimento sea del catálogo pero que también le de un valor a custom_kcal, que sirve para guardar las calorías totales de un alimento personalizado que se haya añadido. Si se pudiera hacer eso de alguna manera, podría generar problemas a la hora de calcular las calorías totales. Me supongo que lo mejor que podría hacer es que en el modelo de MealAliment, que guardara un campo type, para diferenciar entre alimento que se ha añadido del catálogo de alimentos o que se haya añadido de forma manual (alimento personalizado).<br> Otra duda que he estado pensando, que me ha surgido al estar cambiando los selectors que se encargan de contar las calorías, que yo creo que tiene sentido, es que la API me devuelva la información de MealAliment de tal manera que que nunca pueda tener el frontend tanto custom_kcal como user_aliment, porque ahora mismo, estoy haciendo la comprobación directamente con un if, que me supongo que también tendría que hacer ese check con la API para que nunca me devuelva los 2 a la vez.

- Ahora mismo, al hacer npm install, **se me instala en el frontend, el node_modules**, cosa que no quiero puesto que estoy con la idea de mono-repo.

- **Algunas funciones de mis services conocen en cierta parte la estructura de mi API**, debido a que uso .weekId, .dayId para construir la URL de la request. Lo estoy haciendo así porque si no, me parece demasiado complicado entender qué es lo que se está pasando en la request a la API. En un futuro pienso cambiar eso.

- **Refactorización completa del frontend** en el futuro, casi al finalizar la aplicación, para mejorar dependencias, peticiones a la API innecesarias, legibilidad del código, jerarquía de llamadas correcta, tener misma estructura en todo el frontend para que otra persona pueda leer el código y poder entenderlo.

- **Documentación final de la aplicación fullstack en inglés**

- **Borrar console.logs, poner comentarios claros, etc...**
