# Día 15 - Desarrollo de la aplicación Fullstack (React, Node.js y Express)

## Martes 16 de septiembre de 2025

## Lo conseguido hoy:

### Backend

- Mofidicado el **controller userAliments**, para poder hacer un PUT y modificar un nutritional fact en concreto rápidamente.

### Frontend

- Creada la función update en el **custom hook useMyAliments** para poder hacer el cambio en un nutritional fact.

- Creado el **Thunk changeMyAliment**, que llama al service y posteriormente llama a un nuevo **action creator, llamado updateMyAliment**.

- Creada la función update en el **service de myAliments**, para poder hacer la llamada a la API.

- Modificado el **componente MyAlimentItemList** para que use la función update del custom hook useMyAliments. Ahora, cada nutritional fact es un input que se puede clicar en él, para modificar el nutritional fact en concreto. Para ello, se han tenido que añadir 2 useState para manejar lo que se está cambiando y también para actualizar el cursor cuando se da a Enter para hacer submit en el formulario.

- Modificados los **selectors** para que en caso de el alimento de la comida ya no esté en el catálogo, que no cuente en la suma.

## Lo que se desea realizar:

### Backend

### Frontend

- **Si recargo la página y estoy en una semana en específico, nunca me carga**, ya que en el componente para mostrar una semana en concreto, uso el useParams de la URL para buscar con el useSelector la semana por id, pero para que mi URL tenga el id de la semana, debo de hacer click en ella previamente, por eso al recargar la página, no tengo el weekId de useParams. Esto pasa también con el día y con la comida.

- Cuando estoy en AlimentItemList, añado un alimento del catálogo, voy y borro el alimento del catálogo, y vuelvo a la misma página de AlimentItemList, **no se actualiza** el componente, y queda de una manera NO ADECUADA.

- Componente que muestre como un índice con flechas en qué lugar nos encontramos.

- Si ya se ha iniciado sesión, al recargar, que compruebe que sigue habiendo usuario para poder iniciar, porque si borro el usuario en la base de datos pero tengo el token, puedo seguir creando cosas.

### Comentarios Finales

- **Manejo de errores** falta por implementar en la mayoría de la aplicación.

- **Validaciones de datos de entrada**.

### Problemas que tengo

- **Duda (IMPORTANTE)**: Si ahora mismo, como tengo el modelo de MealAliment, me supongo que se podría hacer un POST en el que se pudiera añadir un alimento a una comida, que ese alimento sea del catálogo pero que también le de un valor a custom_kcal, que sirve para guardar las calorías totales de un alimento personalizado que se haya añadido. Si se pudiera hacer eso de alguna manera, podría generar problemas a la hora de calcular las calorías totales. Me supongo que lo mejor que podría hacer es que en el modelo de MealAliment, que guardara un campo type, para diferenciar entre alimento que se ha añadido del catálogo de alimentos o que se haya añadido de forma manual (alimento personalizado).<br> Otra duda que he estado pensando, que me ha surgido al estar cambiando los selectors que se encargan de contar las calorías, que yo creo que tiene sentido, es que la API me devuelva la información de MealAliment de tal manera que que nunca pueda tener el frontend tanto custom_kcal como user_aliment, porque ahora mismo, estoy haciendo la comprobación directamente con un if, que me supongo que también tendría que hacer ese check con la API para que nunca me devuelva los 2 a la vez.

- Ahora mismo, al hacer npm install, **se me instala en el frontend, el node_modules**, cosa que no quiero puesto que estoy con la idea de mono-repo.

- **Algunas funciones de mis services conocen en cierta parte la estructura de mi API**, debido a que uso .weekId, .dayId para construir la URL de la request. Lo estoy haciendo así porque si no me parece demasiado complicado entender qué es lo que se está pasando en la request a la API. En un futuro pienso cambiar eso.

- **Uso de los custom hooks bastante lioso**, ya que en WeekSearch llamo a useWeeks desde el mismo desestructurando las funciones y las paso como props a los componentes que las necesiten. Lo hago así ya que este custom hook dentro tiene un useEffect que hace llamada a la API con un GET de todas las semanas con todos los datos, y si desestructurara las funciones en cada componente de manera individual sin tener que pasarle como props, harían este GET múltiples veces.<br><br>Posiblemente lo que haga es un nuevo custom hook que use al inicio de la app, al igual que el useInitializeAuth, pero solo hacer el get correspondiente y así quitarme el dolor de cabeza de pasar las funciones como props debido al useEffect que me limita a eso para que no ocurran muchas peticiones GET innecesarias.<br><br>En cambio, para el custom hook useDays: el equivalente de WeekSearch en cuanto a jerarquía / estructura / esquema de llamadas es el componente WeekItem, pero los componentes que usa, esos son los que llaman a este custom hook directamente con las funciones desestructuradas necesarias y no se pasan como props las funciones desde WeekItem.

- **Devolución de datos innecesaria**. Tengo que modificar todos los populate de mi API para que devuelva la información estrictamente necesaria en cualquier petición.

- **Refactorización completa del frontend** en el futuro, casi al finalizar la aplicación, para mejorar dependencias, peticiones a la API innecesarias, legibilidad del código, jerarquía de llamadas correcta, tener misma estructura en todo el frontend para que otra persona pueda leer el código y poder entenderlo.

- **Documentación final de la aplicación fullstack en inglés**

- **Borrar console.logs, poner comentarios claros, etc...**
